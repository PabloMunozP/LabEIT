{% extends "layout_in.html" %}
	{%block body%}

	{% include "/vistas_gestion_solicitudes_prestamos/modals/formulario_solicitud_agil.html" %}

	<section id="tabs" class="project-tab mt-2">
            <div class="container-fluid">

							{% with msgs = get_flashed_messages() %}
			          {% if msgs %}
			            {% for msg in msgs %}
			              {% if msg == "solicitud-no-encontrada"%}
			                <div class="alert alert-warning alert-dismissible fade show" role="alert">
			                  <i class="fas fa-exclamation-triangle mr-2"></i>La solicitud de préstamo no se encuentra registrada. Esto puede deberse a una eliminación reciente.
			                  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
			                  <span aria-hidden="true">&times;</span>
			                  </button>
			                </div>
			              {%endif%}
										{% if msg == "equipo-prestado"%}
											<div class="alert alert-danger alert-dismissible fade show" role="alert">
												<i class="fas fa-times-circle mr-2"></i>El equipo a prestar ya no se encuentra disponible.
												<button type="button" class="close" data-dismiss="alert" aria-label="Close">
												<span aria-hidden="true">&times;</span>
												</button>
											</div>
										{%endif%}
										{% if msg == "equipo-no-existente"%}
											<div class="alert alert-danger alert-dismissible fade show" role="alert">
												<i class="fas fa-times-circle mr-2"></i>El equipo a prestar fue eliminado recientemente.
												<button type="button" class="close" data-dismiss="alert" aria-label="Close">
												<span aria-hidden="true">&times;</span>
												</button>
											</div>
										{%endif%}
										{% if msg == "detalle-eliminado" %}
										<div class="alert alert-success mt-2 alert-dismissible fade show" role="alert">
												<i class="fas fa-check-circle mr-2"></i>El detalle de solicitud ha sido eliminado correctamente.
												<button type="button" class="close" data-dismiss="alert" aria-label="Close">
														<span aria-hidden="true">&times;</span>
												</button>
										</div>
										{% endif %}
										{% if msg == "detalles-seleccionados-eliminados" %}
										<div class="alert alert-success mt-2 alert-dismissible fade show" role="alert">
												<i class="fas fa-check-circle mr-2"></i>Los detalles de solicitud han sido eliminados correctamente.
												<button type="button" class="close" data-dismiss="alert" aria-label="Close">
														<span aria-hidden="true">&times;</span>
												</button>
										</div>
										{% endif %}
										{% if msg == "detalle-finalizado" %}
										<div class="alert alert-success mt-2 alert-dismissible fade show" role="alert">
												<i class="fas fa-check-circle mr-2"></i>La solicitud de préstamo ha sido marcada como finalizada correctamente.
												<button type="button" class="close" data-dismiss="alert" aria-label="Close">
														<span aria-hidden="true">&times;</span>
												</button>
										</div>
										{% endif %}
										{% if msg == "solicitud-registrada" %}
										<div class="alert alert-success mt-2 alert-dismissible fade show" role="alert">
												<i class="fas fa-check-circle mr-2"></i>La solicitud de préstamo ha sido registrada correctamente.
												<button type="button" class="close" data-dismiss="alert" aria-label="Close">
														<span aria-hidden="true">&times;</span>
												</button>
										</div>
										{% endif %}
										{% if msg == "usuario-no-existente"%}
											<div class="alert alert-danger alert-dismissible fade show" role="alert">
												<i class="fas fa-times-circle mr-2"></i>No se ha encontrado un usuario registrado con el RUT ingresado.
												<button type="button" class="close" data-dismiss="alert" aria-label="Close">
												<span aria-hidden="true">&times;</span>
												</button>
											</div>
										{%endif%}
										{% if msg == "error-listas-agiles"%}
											<div class="alert alert-danger alert-dismissible fade show" role="alert">
												<i class="fas fa-times-circle mr-2"></i>Se ha producido un error al registrar los detalles de la solicitud según la lista de equipos.
												<button type="button" class="close" data-dismiss="alert" aria-label="Close">
												<span aria-hidden="true">&times;</span>
												</button>
											</div>
										{%endif%}
										{% if msg == "usuario-sancionado"%}
											<div class="alert alert-danger alert-dismissible fade show" role="alert">
												<i class="fas fa-times-circle mr-2"></i>El usuario seleccionado se encuentra sancionado actualmente.
												<button type="button" class="close" data-dismiss="alert" aria-label="Close">
												<span aria-hidden="true">&times;</span>
												</button>
											</div>
										{%endif%}
			            {%endfor%}
			          {%endif%}
			        {%endwith%}

                <div class="row">
                    <div class="col-md-12">
                        <nav>
                            <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
																<a class="nav-item nav-link" id="nav-canasta-solicitudes-tab" data-toggle="tab" href="#nav-canasta-solicitudes" role="tab" aria-controls="nav-canasta-solicitudes" aria-selected="false"><i class="fas fa-box-open mr-2"></i>Solicitudes de préstamos</a>
																<a class="nav-item nav-link active" id="nav-lista-prestamos-activos-tab" data-toggle="tab" href="#nav-lista-prestamos-activos" role="tab" aria-controls="nav-lista-prestamos-activos" aria-selected="true"><i class="fas fa-list mr-2"></i>Lista de detalles de solicitudes de préstamos</a>
																<a class="nav-item nav-link" id="nav-historial-prestamos-tab" data-toggle="tab" href="#nav-historial-prestamos" role="tab" aria-controls="nav-historial-prestamos" aria-selected="false"><i class="fas fa-history mr-2"></i>Historial de solicitudes</a>
                            </div>
                        </nav>
                        <div class="tab-content" id="nav-tabContent">
														<div class="tab-pane fade" id="nav-canasta-solicitudes" role="tabpanel" aria-labelledby="nav-canasta-solicitudes-tab">
															{% include "/vistas_gestion_solicitudes_prestamos/lista_canastas_solicitudes.html" %}
														</div>
                            <div class="tab-pane fade show active" id="nav-lista-prestamos-activos" role="tabpanel" aria-labelledby="nav-lista-prestamos-activos-tab">
															{% include "/vistas_gestion_solicitudes_prestamos/lista_solicitudes_activas.html" %}
                            </div>
                            <div class="tab-pane fade" id="nav-historial-prestamos" role="tabpanel" aria-labelledby="nav-historial-prestamos-tab">
															{% include "/vistas_gestion_solicitudes_prestamos/historial_solicitudes.html" %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

<script type="text/javascript">
	$(document).ready(function() {
			$('#tabla_solicitudes_por_revisar, #tabla_solicitudes_activas, #tabla_historial_solicitudes, #tabla_solicitudes_canastas').DataTable( {
					"order": [[ 0, "desc" ]],
					"language": {
							"lengthMenu": "Mostrar _MENU_ registros por página",
							"zeroRecords": "No se han encontrado registros.",
							"info": "Mostrando página _PAGE_ de _PAGES_",
							"infoEmpty": "Sin registros disponibles.",
							"search":         "Buscar",
							"paginate": {
									"next":       "Siguiente",
									"previous":   "Anterior"
							},
							"infoFiltered": "(filtrado de _MAX_ registros totales)"
						}
				} );
		} );
</script>


	{% endblock %}
